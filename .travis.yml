sudo: false
notifications:
  hipchat:
    rooms:
      secure: LW5XPoH6eOe/VPAVg1vOUk0jvWm662w8R30Wna0ZtcE2ZV40EHmyJfY7PLDA3/o/wme0vHhZh+cKWjbHbhF7RFrYAkNl6RLgmRkvMhaI/UKpztWRfIuopiJg2snHT0bH3nODm/2l9iSyhBc39lpxARFAhsUoN6j5zLyLyqfA7Xg=
addons:
  sauce_connect: true
language: node_js
node_js:
- 0.10
- 0.12
- iojs-v1.2
cache:
  directories:
    - node_modules
install:
- npm install -g gulp
- npm install
before_script:
- export DISPLAY=:99.0
- sh -e /etc/init.d/xvfb start
- sleep 3
- gulp build --mock-backend
- gulp node-server &
- sleep 3
script:
- gulp test
- npm run protractor
after_script:
- gulp send-stats-to-coveralls
before_deploy:
- gulp release --version-suffix=${TRAVIS_TAG:-$TRAVIS_COMMIT}
deploy:
  - provider: releases
    api_key:
      secure: Txqa+XwZOOdAaxRckHGXSCkT7GEUh4R6R0MtTu8otA1Vv2/W5qTICuFnaEzV/FVWrSzYbMwM+mAFHQ1L8SXOnAvbSFwnjaOjIvaEUESItkSITDXncTJItJatzMUXT0SjRTm4Jy6LQ0Pq0qXxfWD6DzsWxPVPsthprb+aEzS0/m8=
    file: build/*
    file_glob: true
    skip_cleanup: true
    on:
      repo: ushahidi/platform-client
      node: 0.12
      tags: true
      all_branches: true

env:
  TX_USERNAME:
    secure: CLYb6szr2patN3sK45BQEaPRFG88w+8p/8ebMZEiq37JCe/X+O1JRISyPFuyMNYltbcGmy3MRL+eCY2V+WHUCa0+EMN270v+XDKLjA/OnW5cTWeY+38j6EdXgFcKcISySSbFXppDfZ3pgS0aDoTJ+oT7Prv3YyKzYFBgqCfxkJg=
  TX_PASSWORD:
    secure: bNhAOSNl828bYWOQEX8/bvU2bsH/KAxjPCr7MKt6n39Oxn1Myh3msMQ3qFiGe/XGQOvbcEUSREKnxxcnRhfFSfnsHGYzYkZschppP2X1OgKYFvyquYUFFdSuhZXYdWGKr8upTzFaHh7EvvhM8FVtKYqZawnFQSR0TBvDSCLYKiQ=
