<form name="postForm" ng-submit="savePost()" novalidate>
  <div class="mode-context init" dropdown>
    <header class="mode-context-header">
        <ol class="breadcrumbs">
            <li><a href="/" ng-controller="navigation as nav">{{nav.site.name}}</a></li>
        </ol>

        <h1 class="mode-context-title">{{post.form.name}}</h1>
    </header>

    <span class="mode-context-trigger" dropdown-toggle>
        <svg class="iconic">
            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="../../img/iconic-sprite.svg#chevron-bottom"></use>
        </svg>
        <span class="label hidden" translate="app.show_more_less">Show more/less</span>
    </span>

    <div class="mode-context-body">
        <p>{{post.form.description}}</p>
    </div>
  </div>

  <main role="main">
      <div class="toolbar">
          <div class="button-group">
              <button type="button" class="button-flat" ng-click="cancel()" translate="app.cancel">Cancel</button>
              <button type="submit" class="button-alpha" translate="app.save">Save</button>
          </div>
      </div>

     <div class="main-col">

          <div class="form-sheet">
              <div class="post-band" style="background-color: {{form.color}}"></div>
              <div class="form-field title form-field-adapt init"
              adaptive-form
              ng-class="{
                'error': postForm.title.$invalid && postForm.title.$dirty,
                'success': !postForm.title.$invalid && postForm.title.$dirty
              }">
                  <label translate="post.modify.form.title">Title</label>
                  <input id="title"
                      name="title" type="text" ng-model="post.title" required ng-minlength=2 ng-maxlength=150 adaptive-input>

                  <div
                      class="alert error"
                      ng-show="form.title.$dirty"
                      ng-repeat="(error, value) in postForm.title.$error"
                      >
                      <svg class="iconic">
                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="../../img/iconic-sprite.svg#warning"></use>
                      </svg>
                      <span translate="{{'post.valid.title.' + error}}"></span>
                  </div>
              </div>
              <div class="toolbox">
                  <!-- IF: User has permission to manage post status -->
                  <div class="tool">
                    <!-- IF: User has permission to manage who it's visible to -->
                      <publish-selector ng-show="allowedChangeStatus()" post="post" ></publish-selector>
                    <!-- END: IF -->
                  </div>
                  <!-- END: IF -->

                  <!--// IF: User has permission to change the author & post timestamp //-->
                  <div class="tool">
                      <h6 class="tool-heading">Author</h6>

                      <span class="tool-trigger init" data-toggle="toggle-content">
                          <svg class="iconic">
                              <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="../../img/iconic-sprite.svg#chevron-bottom"></use>
                          </svg>
                          <span class="label hidden">Show/hide</span>
                      </span>

                      <div class="toggle-content init active">
                          <div class="listing-item">
                              <div class="listing-item-primary">
                                  <div class="listing-item-image">
                                      <img class="avatar" src="http://placehold.it/100x100" alt="">
                                  </div>
                                  <h2 class="listing-item-title">Jess Shorland</h2>
                                  <p class="listing-item-secondary">Editor</p>
                              </div>
                          </div>
                          <button type="button" class="button-gamma button-flat" data-modal="edit-author">Change author</button>
                      </div>
                  </div>

                  <div class="tool">
                      <h6 class="tool-heading">Post date</h6>

                      <span class="tool-trigger init active" data-toggle="toggle-content">
                          <svg class="iconic">
                              <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="../../img/iconic-sprite.svg#chevron-bottom"></use>
                          </svg>
                          <span class="label hidden">Show/hide</span>
                      </span>

                      <div class="toggle-content init active">
                          <fieldset>
                              <legend class="hidden">Post date</legend>
                              <div class="form-field date">
                                  <label class="hidden">Date</label>
                                  <div class="input-with-icon">
                                      <svg class="iconic">
                                          <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="../../img/iconic-sprite.svg#calendar"></use>
                                      </svg>
                                      <input type="text" value="2016-06-22" placeholder="Date" readonly="" id="P902007466" class="picker__input" aria-haspopup="true" aria-expanded="false" aria-readonly="false" aria-owns="P902007466_root"><div class="picker" id="P902007466_root" aria-hidden="true"><div class="picker__holder" tabindex="-1"><div class="picker__frame"><div class="picker__wrap"><div class="picker__box"><div class="picker__header"><div class="picker__month">December</div><div class="picker__year">1901</div><div class="picker__nav--prev" data-nav="-1" role="button" aria-controls="P902007466_table" title="Previous month"> </div><div class="picker__nav--next" data-nav="1" role="button" aria-controls="P902007466_table" title="Next month"> </div></div><table class="picker__table" id="P902007466_table" role="grid" aria-controls="P902007466" aria-readonly="true"><thead><tr><th class="picker__weekday" scope="col" title="Sunday">Sun</th><th class="picker__weekday" scope="col" title="Monday">Mon</th><th class="picker__weekday" scope="col" title="Tuesday">Tue</th><th class="picker__weekday" scope="col" title="Wednesday">Wed</th><th class="picker__weekday" scope="col" title="Thursday">Thu</th><th class="picker__weekday" scope="col" title="Friday">Fri</th><th class="picker__weekday" scope="col" title="Saturday">Sat</th></tr></thead><tbody><tr><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2148577200000" role="gridcell" aria-label="December 1, 1901">1</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2148490800000" role="gridcell" aria-label="December 2, 1901">2</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2148404400000" role="gridcell" aria-label="December 3, 1901">3</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2148318000000" role="gridcell" aria-label="December 4, 1901">4</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2148231600000" role="gridcell" aria-label="December 5, 1901">5</div></td><td role="presentation"><div class="picker__day picker__day--infocus picker__day--selected picker__day--highlighted" data-pick="-2148145200000" role="gridcell" aria-label="December 6, 1901" aria-activedescendant="true">6</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2148058800000" role="gridcell" aria-label="December 7, 1901">7</div></td></tr><tr><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2147972400000" role="gridcell" aria-label="December 8, 1901">8</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2147886000000" role="gridcell" aria-label="December 9, 1901">9</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2147799600000" role="gridcell" aria-label="December 10, 1901">10</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2147713200000" role="gridcell" aria-label="December 11, 1901">11</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2147626800000" role="gridcell" aria-label="December 12, 1901">12</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2147540400000" role="gridcell" aria-label="December 13, 1901">13</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2147454000000" role="gridcell" aria-label="December 14, 1901">14</div></td></tr><tr><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2147367600000" role="gridcell" aria-label="December 15, 1901">15</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2147281200000" role="gridcell" aria-label="December 16, 1901">16</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2147194800000" role="gridcell" aria-label="December 17, 1901">17</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2147108400000" role="gridcell" aria-label="December 18, 1901">18</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2147022000000" role="gridcell" aria-label="December 19, 1901">19</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2146935600000" role="gridcell" aria-label="December 20, 1901">20</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2146849200000" role="gridcell" aria-label="December 21, 1901">21</div></td></tr><tr><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2146762800000" role="gridcell" aria-label="December 22, 1901">22</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2146676400000" role="gridcell" aria-label="December 23, 1901">23</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2146590000000" role="gridcell" aria-label="December 24, 1901">24</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2146503600000" role="gridcell" aria-label="December 25, 1901">25</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2146417200000" role="gridcell" aria-label="December 26, 1901">26</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2146330800000" role="gridcell" aria-label="December 27, 1901">27</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2146244400000" role="gridcell" aria-label="December 28, 1901">28</div></td></tr><tr><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2146158000000" role="gridcell" aria-label="December 29, 1901">29</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2146071600000" role="gridcell" aria-label="December 30, 1901">30</div></td><td role="presentation"><div class="picker__day picker__day--infocus" data-pick="-2145985200000" role="gridcell" aria-label="December 31, 1901">31</div></td><td role="presentation"><div class="picker__day picker__day--outfocus" data-pick="-2145898800000" role="gridcell" aria-label="January 1, 1902">1</div></td><td role="presentation"><div class="picker__day picker__day--outfocus" data-pick="-2145812400000" role="gridcell" aria-label="January 2, 1902">2</div></td><td role="presentation"><div class="picker__day picker__day--outfocus" data-pick="-2145726000000" role="gridcell" aria-label="January 3, 1902">3</div></td><td role="presentation"><div class="picker__day picker__day--outfocus" data-pick="-2145639600000" role="gridcell" aria-label="January 4, 1902">4</div></td></tr><tr><td role="presentation"><div class="picker__day picker__day--outfocus" data-pick="-2145553200000" role="gridcell" aria-label="January 5, 1902">5</div></td><td role="presentation"><div class="picker__day picker__day--outfocus" data-pick="-2145466800000" role="gridcell" aria-label="January 6, 1902">6</div></td><td role="presentation"><div class="picker__day picker__day--outfocus" data-pick="-2145380400000" role="gridcell" aria-label="January 7, 1902">7</div></td><td role="presentation"><div class="picker__day picker__day--outfocus" data-pick="-2145294000000" role="gridcell" aria-label="January 8, 1902">8</div></td><td role="presentation"><div class="picker__day picker__day--outfocus" data-pick="-2145207600000" role="gridcell" aria-label="January 9, 1902">9</div></td><td role="presentation"><div class="picker__day picker__day--outfocus" data-pick="-2145121200000" role="gridcell" aria-label="January 10, 1902">10</div></td><td role="presentation"><div class="picker__day picker__day--outfocus" data-pick="-2145034800000" role="gridcell" aria-label="January 11, 1902">11</div></td></tr></tbody></table><div class="picker__footer"><button class="picker__button--today" type="button" data-pick="1470283200000" disabled="" aria-controls="P902007466">Choose today</button><button class="picker__button--clear" type="button" data-clear="1" disabled="" aria-controls="P902007466">Clear</button><button class="picker__button--close" type="button" data-close="true" disabled="" aria-controls="P902007466">Close</button></div></div></div></div></div></div>
                                  </div>
                              </div>

                              <div class="form-field date">
                                  <label class="hidden">Time</label>
                                  <div class="input-with-icon">
                                      <svg class="iconic">
                                          <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="../../img/iconic-sprite.svg#clock"></use>
                                      </svg>
                                      <input type="text" value="11:39:57" placeholder="Time" readonly="" id="P1597081949" class="picker__input" aria-haspopup="true" aria-expanded="false" aria-readonly="false" aria-owns="P1597081949_root"><div class="picker picker--time" id="P1597081949_root" aria-hidden="true"><div class="picker__holder" tabindex="-1" style=""><div class="picker__frame"><div class="picker__wrap"><div class="picker__box"><ul class="picker__list" role="listbox" aria-controls="P1597081949"><li class="picker__list-item" data-pick="0" role="option" aria-label="12:00 AM">12:00 AM</li><li class="picker__list-item" data-pick="30" role="option" aria-label="12:30 AM">12:30 AM</li><li class="picker__list-item" data-pick="60" role="option" aria-label="1:00 AM">1:00 AM</li><li class="picker__list-item" data-pick="90" role="option" aria-label="1:30 AM">1:30 AM</li><li class="picker__list-item" data-pick="120" role="option" aria-label="2:00 AM">2:00 AM</li><li class="picker__list-item" data-pick="150" role="option" aria-label="2:30 AM">2:30 AM</li><li class="picker__list-item" data-pick="180" role="option" aria-label="3:00 AM">3:00 AM</li><li class="picker__list-item" data-pick="210" role="option" aria-label="3:30 AM">3:30 AM</li><li class="picker__list-item" data-pick="240" role="option" aria-label="4:00 AM">4:00 AM</li><li class="picker__list-item" data-pick="270" role="option" aria-label="4:30 AM">4:30 AM</li><li class="picker__list-item" data-pick="300" role="option" aria-label="5:00 AM">5:00 AM</li><li class="picker__list-item" data-pick="330" role="option" aria-label="5:30 AM">5:30 AM</li><li class="picker__list-item" data-pick="360" role="option" aria-label="6:00 AM">6:00 AM</li><li class="picker__list-item" data-pick="390" role="option" aria-label="6:30 AM">6:30 AM</li><li class="picker__list-item" data-pick="420" role="option" aria-label="7:00 AM">7:00 AM</li><li class="picker__list-item" data-pick="450" role="option" aria-label="7:30 AM">7:30 AM</li><li class="picker__list-item" data-pick="480" role="option" aria-label="8:00 AM">8:00 AM</li><li class="picker__list-item" data-pick="510" role="option" aria-label="8:30 AM">8:30 AM</li><li class="picker__list-item" data-pick="540" role="option" aria-label="9:00 AM">9:00 AM</li><li class="picker__list-item" data-pick="570" role="option" aria-label="9:30 AM">9:30 AM</li><li class="picker__list-item" data-pick="600" role="option" aria-label="10:00 AM">10:00 AM</li><li class="picker__list-item" data-pick="630" role="option" aria-label="10:30 AM">10:30 AM</li><li class="picker__list-item" data-pick="660" role="option" aria-label="11:00 AM">11:00 AM</li><li class="picker__list-item" data-pick="690" role="option" aria-label="11:30 AM">11:30 AM</li><li class="picker__list-item picker__list-item--selected picker__list-item--highlighted picker__list-item--viewset" data-pick="720" role="option" aria-label="12:00 PM" aria-activedescendant="true">12:00 PM</li><li class="picker__list-item" data-pick="750" role="option" aria-label="12:30 PM">12:30 PM</li><li class="picker__list-item" data-pick="780" role="option" aria-label="1:00 PM">1:00 PM</li><li class="picker__list-item" data-pick="810" role="option" aria-label="1:30 PM">1:30 PM</li><li class="picker__list-item" data-pick="840" role="option" aria-label="2:00 PM">2:00 PM</li><li class="picker__list-item" data-pick="870" role="option" aria-label="2:30 PM">2:30 PM</li><li class="picker__list-item" data-pick="900" role="option" aria-label="3:00 PM">3:00 PM</li><li class="picker__list-item" data-pick="930" role="option" aria-label="3:30 PM">3:30 PM</li><li class="picker__list-item" data-pick="960" role="option" aria-label="4:00 PM">4:00 PM</li><li class="picker__list-item" data-pick="990" role="option" aria-label="4:30 PM">4:30 PM</li><li class="picker__list-item" data-pick="1020" role="option" aria-label="5:00 PM">5:00 PM</li><li class="picker__list-item" data-pick="1050" role="option" aria-label="5:30 PM">5:30 PM</li><li class="picker__list-item" data-pick="1080" role="option" aria-label="6:00 PM">6:00 PM</li><li class="picker__list-item" data-pick="1110" role="option" aria-label="6:30 PM">6:30 PM</li><li class="picker__list-item" data-pick="1140" role="option" aria-label="7:00 PM">7:00 PM</li><li class="picker__list-item" data-pick="1170" role="option" aria-label="7:30 PM">7:30 PM</li><li class="picker__list-item" data-pick="1200" role="option" aria-label="8:00 PM">8:00 PM</li><li class="picker__list-item" data-pick="1230" role="option" aria-label="8:30 PM">8:30 PM</li><li class="picker__list-item" data-pick="1260" role="option" aria-label="9:00 PM">9:00 PM</li><li class="picker__list-item" data-pick="1290" role="option" aria-label="9:30 PM">9:30 PM</li><li class="picker__list-item" data-pick="1320" role="option" aria-label="10:00 PM">10:00 PM</li><li class="picker__list-item" data-pick="1350" role="option" aria-label="10:30 PM">10:30 PM</li><li class="picker__list-item" data-pick="1380" role="option" aria-label="11:00 PM">11:00 PM</li><li class="picker__list-item" data-pick="1410" role="option" aria-label="11:30 PM">11:30 PM</li><li role="presentation"><button class="picker__button--clear button" type="button" data-clear="1" aria-controls="P1597081949" disabled="disabled">Clear</button></li></ul></div></div></div></div></div>
                                  </div>
                              </div>

                              <div class="metadata">
                                  <ul>
                                      <li><strong>Created</strong> at 4:34 p.m. March 26, 2016 via web</li>
                                      <li><strong>Last updated</strong> at 11:01 a.m. April 5, 2016</li>
                                  </ul>
                              </div>
                          </fieldset>
                      </div>
                  </div>
                  <!-- END: IF -->
              </div>

              <!-- Post stage default fields -->
              <div class="form-field form-field-adapt init"
                  ng-class="{
                    'error': form.content.$invalid && form.content.$dirty,
                    'success': !form.content.$invalid && form.content.$dirty
                  }"
                  adaptive-form>
                  <label translate="post.modify.form.description">
                      Description
                  </label>
                  <textarea id="content" name="content" data-min-rows="1" rows="1" class="adapt-field" style="overflow-x: hidden; word-wrap: break-word; height: 55px;"
                      ng-model="post.content" required adaptive-input msd-elastic>
                  </textarea>

                  <div class="alert error" ng-show="form.content.$dirty" ng-repeat="(error, value) in form.content.$error">
                      <svg class="iconic">
                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="../../img/iconic-sprite.svg#warning"></use>
                      </svg>
                      <span translate="{{'post.valid.content.' + error}}"></span>
                  </div>
              </div>

              <!-- End post stage default fields -->

              <!-- Start Post custom fields -->
              <post-value-edit
                      ng-repeat="attribute in tasks[0].attributes | orderBy: 'priority' as filtered_result track by attribute.id"
                      post="post"
                      form="postForm"
                      attribute="attribute"
              ></post-value-edit>
              <!-- End Post custom fields -->

              <fieldset id="categories" ng-show="categories.length">
                  <legend translate="post.modify.form.categories">Categories</legend>
                  <div class="form-field checkbox" ng-repeat="category in categories">
                      <label for="cat1">
                          <input type="checkbox" value="category.id" name="tags" checklist-model="post.tags" checklist-value="category.id">
                          <span>{{category.tag}}</span>
                      </label>
                  </div>
              </fieldset>

              <!-- IF: Editing an existing post -->
              <post-metadata post="post" ng-if="post.id"></post-metadata>
              <!-- ELSE IF: Adding a new post w/o permission to manage who it's visible to
              <div class="postcard-metadata">
                  <strong>This post will need to be moderated</strong> before it's visible to the public.
              </div>
              END: IF -->



             <!-- IF: User has permission to see other 'Tasks' -->


         </div>
         <post-tabs
             form="postForm"
             post="post"
             stages="tasks"
             attributes="attributes"
             visible-stage="visibleStage">
          </post-tabs>
          <div class="form-sheet" ng-if="post.id">
              <div class="form-sheet-summary">
                  <h3 class="form-sheet-title" translate="post.delete_post">Delete this post</h3>
              </div>

              <div class="form-field">
                  <p translate="post.delete_post_desc"><strong>If you delete this post</strong>, all of its comments and messages will also be deleted. Proceed with caution.</p>

                  <button class="button-destructive" ng-click="deletePost(post)">
                      <svg class="iconic">
                          <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="../../img/iconic-sprite.svg#trash"></use>
                      </svg>
                      <span class="button-label" translate="post.delete_post">Delete post</span>
                  </button>
              </div>
          </div>

      </div> <!-- END main column -->

  </main>
</form>
